# 主机租赁接口

#### 1. 创建按量主机

**Path**

`POST`   `https://stg-client.xuandashi.com/v1/pve/open/createquantity`

**Request paramerter**

| Parameter           | Description                                  | Required | Type   | Location |
| ------------------- | -------------------------------------------- | -------- | ------ | -------- |
| Finovy-Access-Token | 令牌-口令                                    | yes      | string | header   |
| package_id          | 主机模板ID（主机模板type需要和镜像type一致） | yes      | string | body     |
| image_id            | 镜像ID（镜像type需要和主机模板type一致）     | yes      | string | body     |

**Response Type**:application/json

**Response Example**

```json
{
    "code":0,
    "data":true,
    "msg":"success",
    "traceId":"xxxxxxxxxxxxxx"
}
```

**code**

| 错误码 | 错误描述                     |
| ------ | ---------------------------- |
| 1001   | 权限不足                     |
| 7005   | 主机模板类型与镜像类型不一致 |

#### 2. 创建包时段主机

**Path**

`POST`   `https://stg-client.xuandashi.com/v1/pve/open/createRent`

**Request paramerter**

| Parameter           | Description                                      | Required | Type   | Location |
| ------------------- | ------------------------------------------------ | -------- | ------ | -------- |
| Finovy-Access-Token | 令牌-口令                                        | yes      | string | header   |
| package_id          | 主机模板ID（主机模板type需要和镜像type一致）     | yes      | string | body     |
| image_id            | 镜像ID（镜像type需要和主机模板type一致）         | yes      | string | body     |
| period_number       | 购买周期                                         | yes      | int    | body     |
| period_type         | 购买周期类型（0小时、1日、2周、3月、4季度、5年） | yes      | int    | body     |

**Response Type**:application/json

**Response Example**

```json
{
    "code":0,
    "data":"dyMFQQgHIW",
    "msg":"success",
    "traceId":"xxxxxxxxxxxxxx"
}
```

| Responses Parameter | Description | Type   |
| ------------------- | ----------- | ------ |
| data                | 主机ID      | string |

**code**

| 错误码 | 错误描述                     |
| ------ | ---------------------------- |
| 1001   | 权限不足                     |
| 1037   | 未进行实名认证               |
| 6002   | 资源不足, 请重新选择配置     |
| 6005   | 创建等待                     |
| 7005   | 主机模板类型与镜像类型不一致 |
| 9000   | 钱包异常                     |
| 9001   | 钱包余额不足                 |

#### 3. 开机/关机

**Path**

`GET`   `https://stg-client.xuandashi.com/v1/pve/open/operate/{id}`

**Request paramerter**

| Parameter           | Description                     | Required | Type   | Location |
| ------------------- | ------------------------------- | -------- | ------ | -------- |
| Finovy-Access-Token | 令牌-口令                       | yes      | string | header   |
| id                  | 主机ID                          | yes      | string | path     |
| type                | 0：关闭虚拟机     1：开启虚拟机 | yes      | string | query    |

**Response Type**:application/json

**Response Example**

```json
{
    "code":0,
    "data":true,
    "msg":"success",
    "traceId":"xxxxxxxxxxxxxx"
}
```

**code**

| 错误码 | 错误描述                 |
| ------ | ------------------------ |
| 1001   | 权限不足                 |
| 6000   | 开机中                   |
| 6001   | 关机中                   |
| 6002   | 资源不足, 请重新选择配置 |
| 6003   | 钱包余额不足             |

#### 4. 重启

**Path**

`GET `   `https://stg-client.xuandashi.com/v1/pve/open/reboot/{id}`

**Request paramerter**

| Parameter           | Description | Required | Type   | Location |
| ------------------- | ----------- | -------- | ------ | -------- |
| Finovy-Access-Token | 令牌-口令   | yes      | string | header   |
| id                  | 主机ID      | yes      | string | path     |

**Response Type**:application/json

**Response Example**

```json
{
    "code":0,
    "data":true,
    "msg":"success",
    "traceId":"xxxxxxxxxxxxxx"
}
```

**code**

| 错误码 | 错误描述               |
| ------ | ---------------------- |
| 7002   | 未启动的主机不能重启   |
| 7003   | 虚拟机不可用，不能重启 |
| 7004   | 主机未运行，不能重启   |

#### 5. 查询虚拟机信息

**Path**

`GET `   `https://stg-client.xuandashi.com/v1/pve/open/one/{id}`

**Request paramerter**

| Parameter           | Description | Required | Type   | Location |
| ------------------- | ----------- | -------- | ------ | -------- |
| Finovy-Access-Token | 令牌-口令   | yes      | string | header   |
| id                  | 主机ID      | yes      | string | path     |

**Response Type**:application/json

**Response Example**

```JSON
{
    "code":0,
    "data":{
       "id":"QzyHraLXEr",
       "name":"master_xuan",
       "gpu_configuration":"GeForce GTX 1660 Ti/S 6G",
       "gpu_cumber":2,
       "memory":8,
       "cpu":8,
       "rigid_disk":256,
       "operating_system":"Ubuntu Server",
       "host_account":"root",
       "host_pw":"***********",
       "address":"xxxx.xxx-xxx.com", 
       "use_type":"0",
       "port":8080,
       "mac":"*********",
       "ipv4":"*********",
       "pve_machine_type" :"0",
       "create_time":1695639270000,
       "expiration_time":1695639850000
   },
    "msg":"success",
    "traceId":"xxxxxxxxxxxxxx"
}
```

| Responses Parameter | Description                                                 | Type   |
| :------------------ | :---------------------------------------------------------- | ------ |
| id                  | 主机ID                                                      | string |
| name                | 主机名称                                                    | string |
| gpu_configuration   | GPU配置                                                     | string |
| gpu_number          | GPU数量                                                     | int    |
| memory              | 内存数                                                      | int    |
| cpu                 | cpu核数                                                     | int    |
| rigid_disk          | 硬盘数                                                      | int    |
| operating_system    | 操作系统（Windows,Windows Server,Ubuntu Server,Debian）     | string |
| host_account        | 用户名（登录用户名）                                        | string |
| address             | 主机连接地址                                                | string |
| port                | 主机连接端口                                                | int    |
| pve_machine_type    | 主机使用范围，用途（0：普通办公、1：图像处理、2：算法区域） | string |
| create_time         | 主机创建时间                                                | long   |
| expiration_time     | 主机到期时间，有可能为空                                    | long   |
| mac                 | MAC地址                                                     | string |
| ipv4                | ip地址                                                      | string |
| use_type            | 主机类型（0按量，1包时段）                                  | string |

#### 6. 批量查询虚拟机信息

**Path**

`GET`   `https://stg-client.xuandashi.com/v1/pve/open/mypage`

**Request paramerter**

| Parameter           | Description                    | Required | Type    | Location |
| ------------------- | ------------------------------ | -------- | ------- | -------- |
| Finovy-Access-Token | 令牌-口令                      | yes      | string  | header   |
| page                | 起始页                         | yes      | integer | query    |
| pageSize            | 页大小，单次最多只支持查询25条 | yes      | integer | query    |

**Response Type**:application/json

**Response Example**

```json
{
    "code":0,
    "data":{"data":
    [
       {
           "id":"QzyHraLXEr",
           "name":"master_xuan",
           "gpu_configuration":"GeForce GTX 1660 Ti/S 6G",
           "gpu_number":2,
           "memory":8,
           "cpu":8,
           "rigid_disk":256,
           "operating_system":"Ubuntu Server",
           "host_account":"root",
           "host_pw":"***********",
           "address":"xxxx.xxx-xxx.com", 
           "use_type":"0",
           "port":8080,
           "pve_machine_type" :"0",
           "create_time":1695639270000,
           "expiration_time":1695639850000
       }
    ],
    "totalCounts":1
 },
    "msg":"success",
    "traceId":"xxxxxxxxxxxxxx"
}
```

| Responses Parameter | Description                                                 | Type   |
| :------------------ | :---------------------------------------------------------- | ------ |
| id                  | 主机ID                                                      | string |
| name                | 主机名称                                                    | string |
| gpu_configuration   | GPU配置                                                     | string |
| gpu_number          | GPU数量                                                     | int    |
| memory              | 内存数                                                      | int    |
| cpu                 | cpu核数                                                     | int    |
| rigid_disk          | 硬盘数                                                      | int    |
| operating_system    | 操作系统（Windows,Windows Server,Ubuntu Server,Debian）     | string |
| host_account        | 用户名（登录用户名）                                        | string |
| address             | 主机连接地址                                                | string |
| port                | 主机连接端口                                                | int    |
| pve_machine_type    | 主机使用范围，用途（0：普通办公、1：图像处理、2：算法区域） | string |
| create_time         | 主机创建时间                                                | long   |
| expiration_time     | 主机到期时间，有可能为空                                    | long   |
| use_type            | 主机类型（0按量，1包时段）                                  | string |

#### 7. 删除虚拟机

**Path**

`DELETE`   `https://stg-client.xuandashi.com/v1/pve/open/delete/{id}`

**Response Type**:application/json

**Request paramerter**

| Parameter           | Description | Required | Type   | Location |
| ------------------- | ----------- | -------- | ------ | -------- |
| Finovy-Access-Token | 令牌-口令   | yes      | string | header   |
| id                  | 主机ID      | yes      | string | path     |

**Response Example**

```json
{
    "code":0,
    "data":true,
    "msg":"success",
    "traceId":"xxxxxxxxxxxxxx"
}
```

**code**

| 错误码 | 错误描述 |
| ------ | -------- |
| 1001   | 权限不足 |

#### 8. 主机模板信息

**Path**

`GET`   `https://stg-client.xuandashi.com/v1/pve/open/packAge/{type}`

**Request paramerter**

| Parameter           | Description                | Required | Type   | Location |
| ------------------- | -------------------------- | -------- | ------ | -------- |
| Finovy-Access-Token | 令牌-口令                  | yes      | string | header   |
| type                | 模板类型（0按量、1包时段） | yes      | string | path     |

**Response Type**:application/json

**Response Example**

```json
{
    "code":0,
    "data":[
        {
            "package_id":"Pi8tcH1NSd",
            "name":"图像处理-Ubuntu",
            "memory_number":16,
            "rigid_disk_number":512,
            "amount":5.00,
            "cpu_number":16,
            "band_width":8,
            "type":"BZ",
            "pve_machine_type":"1",
            "area":"2",
            "use_type":"2",
            "discount":0.9
        }
    ],
    "msg":"success",
    "traceId":"xxxxxxxxxxxxxx"
}
```

| Responses Parameter | Description                                                  | Type   |
| ------------------- | ------------------------------------------------------------ | ------ |
| package_id          | 主机模板ID                                                   | string |
| name                | 主机模板名称                                                 | string |
| gpu_number          | GPU数                                                        | int    |
| memory_number       | 内存数                                                       | int    |
| rigid_disk_number   | 硬盘数                                                       | int    |
| cpu_number          | cpu数                                                        | int    |
| band_width          | 带宽                                                         | int    |
| amount              | 金额                                                         | string |
| discount            | 折扣                                                         | string |
| type                | 主机模板类型                                                 | string |
| pve_machine_type    | 主机用途（0普通办公、1图像处理、2算法区域）                  | string |
| area                | 数据中心（0华南、1华西、2国际）                              | string |
| use_type            | 主机使用类型（0仅支持按量、1仅支持包时段、2支持按量和包时段） | string |

#### 9. 镜像信息

**Path**

`GET`   `https://stg-client.xuandashi.com/v1/pve/open/image`

**Request paramerter**

| Parameter           | Description | Required | Type   | Location |
| ------------------- | ----------- | -------- | ------ | -------- |
| Finovy-Access-Token | 令牌-口令   | yes      | string | header   |

**Response Type**:application/json

**Response Example**

```json
{
  "code":0,
  "data":[
    {
      "image_id":"8989",
      "type":"BZ",
      "system_image_name":"Windown Server",
      "system_image_version":"2022 数据中心中文版 x64"
    }
  ],
  "msg":"success",
  "traceId":"xxxxxxxxxxxxxx"
}
```

| Responses Parameter  | Description  | Type   |
| :------------------- | :----------- | ------ |
| image_id             | 镜像ID       | string |
| type                 | 镜像类型     | string |
| system_image_name    | 镜像系统     | string |
| system_image_version | 镜像系统版本 | string |
